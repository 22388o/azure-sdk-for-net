{
    "swagger": "2.0",
    "info": {
        "version": "2022-04-07-preview",
        "title": "Azure Communication ServerCalling APIs"
    },
    "schemes": [
        "https"
    ],
    "consumes": [
        "application/json"
    ],
    "produces": [
        "application/json"
    ],
    "paths": {
        "/calling/callConnections:answer": {
            "post": {
                "tags": [
                    "PreConnections"
                ],
                "summary": "Answer a Call.",
                "description": "Answer a call using the IncomingCallContext from Event Grid.",
                "operationId": "ServerCalling_AnswerCall",
                "parameters": [
                    {
                        "name": "answerCallRequest",
                        "in": "body",
                        "description": "The answer call request.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/AnswerCallRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the answer call response.",
                        "schema": {
                            "$ref": "#/definitions/AnswerCallResponse"
                        }
                    }
                },
                "x-ms-examples": {
                    "Answer a Call.": {
                        "$ref": "./examples/ServerCalling_AnswerCall.json"
                    }
                }
            }
        },
        "/calling/callConnections:redirect": {
            "post": {
                "tags": [
                    "PreConnections"
                ],
                "summary": "Redirect a call.",
                "description": "Redirect a call.",
                "operationId": "ServerCalling_RedirectCall",
                "parameters": [
                    {
                        "name": "redirectCallRequest",
                        "in": "body",
                        "description": "",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/RedirectCallRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the redirect call response."
                    }
                },
                "x-ms-examples": {
                    "Redirect a call.": {
                        "$ref": "./examples/ServerCalling_RedirectCall.json"
                    }
                }
            }
        },
        "/calling/callConnections:reject": {
            "post": {
                "tags": [
                    "PreConnections"
                ],
                "summary": "Reject the call.",
                "description": "Reject the call.",
                "operationId": "ServerCalling_RejectCall",
                "parameters": [
                    {
                        "name": "rejectCallRequest",
                        "in": "body",
                        "description": "The reject call request.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/RejectCallRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the reject call response."
                    }
                },
                "x-ms-examples": {
                    "Reject the call.": {
                        "$ref": "./examples/ServerCalling_RejectCall.json"
                    }
                }
            }
        },
        "/calling/callConnections/{callConnectionId}": {
            "delete": {
                "tags": [
                    "MidConnections"
                ],
                "summary": "Hangup the call.",
                "description": "Hangup the call.",
                "operationId": "CallConnections_HangupCall",
                "parameters": [
                    {
                        "name": "callConnectionId",
                        "in": "path",
                        "description": "The call connection id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Returns the hangup call response."
                    }
                },
                "x-ms-examples": {
                    "Hangup the call.": {
                        "$ref": "./examples/CallConnections_HangupCall.json"
                    }
                }
            }
        },
        "/calling/callConnections/{callConnectionId}:terminate": {
            "post": {
                "tags": [
                    "MidConnections"
                ],
                "summary": "Terminate a call using CallConnectionId.",
                "description": "Terminate a call using CallConnectionId.",
                "operationId": "CallConnections_TerminateCall",
                "parameters": [
                    {
                        "name": "callConnectionId",
                        "in": "path",
                        "description": "The terminate call request.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the terminate call response."
                    }
                },
                "x-ms-examples": {
                    "Terminate a call using CallConnectionId.": {
                        "$ref": "./examples/CallConnections_TerminateCall.json"
                    }
                }
            }
        },
        "/calling/callConnections/{callConnectionId}:transferToParticipant": {
            "post": {
                "tags": [
                    "MidConnections"
                ],
                "summary": "Transfer the call to a participant.",
                "description": "Transfer the call to a participant.",
                "operationId": "CallConnections_TransferToParticipant",
                "parameters": [
                    {
                        "name": "callConnectionId",
                        "in": "path",
                        "description": "The call connection id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "transferToParticipantRequest",
                        "in": "body",
                        "description": "The transfer to participant request.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/TransferToParticipantRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the transfer call response.",
                        "schema": {
                            "$ref": "#/definitions/TransferCallResponse"
                        }
                    }
                },
                "x-ms-examples": {
                    "Transfer the call to a participant.": {
                        "$ref": "./examples/CallConnections_TransferToParticipant.json"
                    }
                }
            }
        },
        "/calling/callConnections/{callConnectionId}:transferToCall": {
            "post": {
                "tags": [
                    "MidConnections"
                ],
                "summary": "Transfer the current call to another call.",
                "description": "Transfer the current call to another call.",
                "operationId": "CallConnections_TransferToCall",
                "parameters": [
                    {
                        "name": "callConnectionId",
                        "in": "path",
                        "description": "The call connection id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "transferToCallRequest",
                        "in": "body",
                        "description": "The transfer to call request.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/TransferToCallRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the transfer call response.",
                        "schema": {
                            "$ref": "#/definitions/TransferCallResponse"
                        }
                    }
                },
                "x-ms-examples": {
                    "Transfer the current call to another call.": {
                        "$ref": "./examples/CallConnections_TransferToCall.json"
                    }
                }
            }
        },
        "/calling/callConnections/{callConnectionId}/participants:add": {
            "post": {
                "tags": [
                    "MidConnections"
                ],
                "summary": "Add participants to the call.",
                "description": "Add participants to the call.",
                "operationId": "CallConnections_AddParticipant",
                "parameters": [
                    {
                        "name": "callConnectionId",
                        "in": "path",
                        "description": "The call connection Id",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "addParticipantsRequest",
                        "in": "body",
                        "description": "The add participants request.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/AddParticipantsRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the add participant response.",
                        "schema": {
                            "$ref": "#/definitions/AddParticipantsResponse"
                        }
                    }
                },
                "x-ms-examples": {
                    "Add participants to the call.": {
                        "$ref": "./examples/CallConnections_AddParticipant.json"
                    }
                }
            }
        },
        "/calling/callConnections/{callConnectionId}/participants:remove": {
            "post": {
                "tags": [
                    "MidConnections"
                ],
                "summary": "Remove participant from the call using identifier.",
                "description": "Remove participant from the call using identifier.",
                "operationId": "CallConnections_RemoveParticipants",
                "parameters": [
                    {
                        "name": "callConnectionId",
                        "in": "path",
                        "description": "The call connection id.",
                        "required": true,
                        "type": "string"
                    },
                    {
                        "name": "removeParticipantsRequest",
                        "in": "body",
                        "description": "The participants to be removed from the call.",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/RemoveParticipantsRequest"
                        }
                    },
                    {
                        "$ref": "#/parameters/ApiVersionParameter"
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Returns the remove participant response.",
                        "schema": {
                            "$ref": "#/definitions/RemoveParticipantsResponse"
                        }
                    }
                },
                "x-ms-examples": {
                    "Remove participant from the call using identifier.": {
                        "$ref": "./examples/CallConnections_RemoveParticipants.json"
                    }
                }
            }
        }
    },
    "definitions": {
        "AnswerCallRequest": {
            "description": "The request payload for answering the call.",
            "required": [
                "incomingCallContext"
            ],
            "type": "object",
            "properties": {
                "incomingCallContext": {
                    "description": "The context associated with the call.",
                    "type": "string"
                },
                "callbackUri": {
                    "description": "The callback uri.",
                    "type": "string"
                }
            }
        },
        "AnswerCallResponse": {
            "description": "The response payload of the answer call operation.",
            "type": "object",
            "properties": {
                "serverCallId": {
                    "description": "The server call id.",
                    "type": "string",
                    "readOnly": true
                },
                "callConnectionId": {
                    "description": "The subscription id.",
                    "type": "string",
                    "readOnly": true
                }
            }
        },
        "RedirectCallRequest": {
            "description": "The request payload for redirecting the call.",
            "required": [
                "incomingCallContext",
                "target"
            ],
            "type": "object",
            "properties": {
                "incomingCallContext": {
                    "description": "The context associated with the call.",
                    "type": "string"
                },
                "target": {
                    "$ref": "#/definitions/CommunicationIdentifierModel",
                    "description": "The target identity to redirect the call to."
                }
            }
        },
        "CommunicationIdentifierModel": {
            "type": "object",
            "properties": {
                "rawId": {
                    "description": "Full ID of the identifier.",
                    "type": "string"
                },
                "communicationUser": {
                    "$ref": "#/definitions/CommunicationUserIdentifierModel",
                    "description": "The communication user."
                },
                "phoneNumber": {
                    "$ref": "#/definitions/PhoneNumberIdentifierModel",
                    "description": "The phone number."
                },
                "microsoftTeamsUser": {
                    "$ref": "#/definitions/MicrosoftTeamsUserIdentifierModel",
                    "description": "The Microsoft Teams user."
                }
            }
        },
        "CommunicationUserIdentifierModel": {
            "type": "object",
            "properties": {
                "id": {
                    "type": "string"
                }
            }
        },
        "PhoneNumberIdentifierModel": {
            "type": "object",
            "properties": {
                "value": {
                    "type": "string"
                }
            }
        },
        "CommunicationCloudEnvironmentModel": {
            "enum": [
                "public",
                "dod",
                "gcch"
            ],
            "type": "string",
            "x-ms-enum": {
                "name": "CommunicationCloudEnvironmentModel",
                "modelAsString": true
            }
        },
        "MicrosoftTeamsUserIdentifierModel": {
            "type": "object",
            "properties": {
                "userId": {
                    "type": "string"
                },
                "isAnonymous": {
                    "type": "boolean"
                },
                "cloud": {
                    "$ref": "#/definitions/CommunicationCloudEnvironmentModel"
                }
            }
        },
        "CallRejectReason": {
            "description": "The rejection reason.",
            "enum": [
                "none",
                "busy",
                "forbidden"
            ],
            "type": "string",
            "x-ms-enum": {
                "name": "CallRejectReason",
                "modelAsString": true
            }
        },
        "RejectCallRequest": {
            "description": "The request payload for rejecting the call.",
            "required": [
                "incomingCallContext"
            ],
            "type": "object",
            "properties": {
                "incomingCallContext": {
                    "description": "The context associated with the call.",
                    "type": "string"
                },
                "callRejectReason": {
                    "$ref": "#/definitions/CallRejectReason"
                }
            }
        },
        "TransferToParticipantRequest": {
            "description": "The transfer call to participant request.",
            "required": [
                "targetParticipant"
            ],
            "type": "object",
            "properties": {
                "targetParticipant": {
                    "$ref": "#/definitions/CommunicationIdentifierModel",
                    "description": "The identity of the target where call should be transferred to."
                },
                "transfereeCallerId": {
                    "$ref": "#/definitions/PhoneNumberIdentifierModel",
                    "description": "The caller ID of the transferee if transferring to a pstn number."
                },
                "userToUserInformation": {
                    "description": "The user to user information.",
                    "type": "string"
                },
                "operationContext": {
                    "description": "The operation context.",
                    "type": "string"
                },
                "transfereeParticipantId": {
                    "description": "The participantId of the transferee (optional).",
                    "type": "string"
                }
            }
        },
        "CallingOperationStatusDto": {
            "description": "The status of the operation",
            "enum": [
                "notStarted",
                "running",
                "completed",
                "failed"
            ],
            "type": "string",
            "x-ms-enum": {
                "name": "CallingOperationStatusDto",
                "modelAsString": true
            }
        },
        "TransferCallResponse": {
            "required": [
                "status"
            ],
            "type": "object",
            "properties": {
                "operationId": {
                    "description": "The operation id.",
                    "type": "string"
                },
                "status": {
                    "$ref": "#/definitions/CallingOperationStatusDto"
                },
                "operationContext": {
                    "description": "The operation context provided by client.",
                    "type": "string"
                },
                "resultDetails": {
                    "$ref": "#/definitions/CallingOperationResultDetailsDto",
                    "description": "The result info for the operation."
                }
            }
        },
        "CallingOperationResultDetailsDto": {
            "required": [
                "code",
                "subcode"
            ],
            "type": "object",
            "properties": {
                "code": {
                    "format": "int32",
                    "description": "The result code associated with the operation.",
                    "type": "integer"
                },
                "subcode": {
                    "format": "int32",
                    "description": "The subcode that further classifies the result.",
                    "type": "integer"
                },
                "message": {
                    "description": "The message is a detail explanation of subcode.",
                    "type": "string"
                }
            }
        },
        "TransferToCallRequest": {
            "description": "The transfer call to other call request. Used for consultative transfers.",
            "required": [
                "targetCallConnectionId"
            ],
            "type": "object",
            "properties": {
                "targetCallConnectionId": {
                    "description": "The call connection id to replace the current call with. This parameter should be used for consultative transfer.",
                    "type": "string"
                },
                "userToUserInformation": {
                    "description": "The user to user information.",
                    "type": "string"
                },
                "operationContext": {
                    "description": "The operation context.",
                    "type": "string"
                },
                "transfereeParticipantId": {
                    "description": "The participantId of the transferee (optional).",
                    "type": "string"
                }
            }
        },
        "AddParticipantsRequest": {
            "required": [
                "participantsToAdd"
            ],
            "type": "object",
            "properties": {
                "sourceCallerId": {
                    "$ref": "#/definitions/PhoneNumberIdentifierModel",
                    "description": "The source caller Id that's shown to the PSTN participant being invited. Required only when inviting a PSTN participant."
                },
                "participantsToAdd": {
                    "description": "The participants to invite.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/CommunicationIdentifierModel"
                    }
                },
                "invitationTimeoutInSeconds": {
                    "format": "int32",
                    "description": "Gets or sets the timeout to wait for the invited participant to pickup.\r\nThe maximum value of this is 180 seconds",
                    "type": "integer"
                },
                "replacementCallConnectionId": {
                    "description": "Replaces the call with this call connection Id after invitation.",
                    "type": "string"
                },
                "operationContext": {
                    "description": "The operation context.",
                    "type": "string"
                }
            }
        },
        "AddParticipantsResponse": {
            "required": [
                "status"
            ],
            "type": "object",
            "properties": {
                "operationId": {
                    "description": "The operation id.",
                    "type": "string"
                },
                "status": {
                    "$ref": "#/definitions/CallingOperationStatusDto"
                },
                "operationContext": {
                    "description": "The operation context provided by client.",
                    "type": "string"
                },
                "resultDetails": {
                    "$ref": "#/definitions/CallingOperationResultDetailsDto",
                    "description": "The result info for the operation."
                }
            }
        },
        "RemoveParticipantsRequest": {
            "description": "The remove participant by identifier request.",
            "required": [
                "participantsToRemove"
            ],
            "type": "object",
            "properties": {
                "participantsToRemove": {
                    "description": "The participants to invite.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/AcsCallParticipantDto"
                    }
                },
                "operationContext": {
                    "description": "The operation context.",
                    "type": "string"
                }
            }
        },
        "AcsCallParticipantDto": {
            "type": "object",
            "properties": {
                "identifier": {
                    "$ref": "#/definitions/CommunicationIdentifierModel",
                    "description": "Communication identifier of the participant"
                },
                "participantId": {
                    "description": "Participant id, will be ignored if Identifier is set",
                    "type": "string"
                },
                "isMuted": {
                    "description": "Is participant muted",
                    "type": "boolean"
                }
            }
        },
        "RemoveParticipantsResponse": {
            "required": [
                "status"
            ],
            "type": "object",
            "properties": {
                "operationId": {
                    "description": "The operation id.",
                    "type": "string"
                },
                "status": {
                    "$ref": "#/definitions/CallingOperationStatusDto"
                },
                "operationContext": {
                    "description": "The operation context provided by client.",
                    "type": "string"
                },
                "resultDetails": {
                    "$ref": "#/definitions/CallingOperationResultDetailsDto",
                    "description": "The result info for the operation."
                }
            }
        }
    },
    "parameters": {
        "ApiVersionParameter": {
            "name": "api-version",
            "in": "query",
            "description": "Version of API to invoke.",
            "required": true,
            "type": "string",
            "x-ms-parameter-location": "method"
        },
        "Endpoint": {
            "name": "endpoint",
            "in": "path",
            "description": "The endpoint of the Azure Communication resource.",
            "required": true,
            "type": "string",
            "x-ms-skip-url-encoding": true,
            "x-ms-parameter-location": "client"
        }
    },
    "x-ms-parameterized-host": {
        "hostTemplate": "{endpoint}",
        "useSchemePrefix": false,
        "parameters": [
            {
                "$ref": "#/parameters/Endpoint"
            }
        ]
    }
}
